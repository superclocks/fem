
	
	SUBROUTINE SOLID0_I(SXY,X,Y,Z,VMAE,SK,SM)
      USE IMSL
      IMPLICIT  REAL*8 (A-H,O-Z)
!     COMMON/STR/E,BO,ROU  !结构的杨氏模量，泊松比，密度
      DIMENSION   SXY(8,3),VN(11),VNN(3,24),VDN(3,11),VJJ(3,3),VJ(3,3),
     $            VD(6,6),VD0(3,11),SK(33,33),SM(24,24),VB(6,33),
     $            VS(33,6),VMAE(4),AA(3,8),VJ0(3,3),VJ1(3,3)
!*******************************************************************
      AA(1,1:4)=-0.125
      AA(1,5:8)= 0.125
      AA(2,1)=-0.125
      AA(2,2:3)= 0.125
	AA(2,4:5)=-0.125
      AA(2,6:7)= 0.125
	AA(2,8)=-0.125
	AA(3,1:2)=-0.125
	AA(3,3:4)= 0.125
	AA(3,5:6)=-0.125
      AA(3,7:8)= 0.125

	DO 9 I=1,3
	DO 9 J=1,3
	VJ0(I,J)=0.0
	DO 9 K=1,8
      VJ0(I,J)=VJ0(I,J)+AA(I,K)*SXY(K,J)
9     CONTINUE
      SJ0=VJ0(1,1)*(VJ0(2,2)*VJ0(3,3)-VJ0(2,3)*VJ0(3,2))-
     $    VJ0(1,2)*(VJ0(2,1)*VJ0(3,3)-VJ0(2,3)*VJ0(3,1))+
     $    VJ0(1,3)*(VJ0(2,2)*VJ0(3,1)-VJ0(2,1)*VJ0(3,2))  !雅克比行列式
      VJ1(:,:)=.I.VJ0(:,:)

	VJ1(:,:)=VJ1(:,:)*ABS(SJ0)

!*******************************************************************


C***************计算SOLID单元的刚度、质量矩阵***********************
!===============SOLID八节点单元的形函数==================
	VN(1)=(1.0-X)*(1.0-Y)*(1.0-Z)*0.125
	VN(2)=(1.0-X)*(1.0+Y)*(1.0-Z)*0.125
	VN(3)=(1.0-X)*(1.0+Y)*(1.0+Z)*0.125
	VN(4)=(1.0-X)*(1.0-Y)*(1.0+Z)*0.125
	VN(5)=(1.0+X)*(1.0-Y)*(1.0-Z)*0.125
	VN(6)=(1.0+X)*(1.0+Y)*(1.0-Z)*0.125
	VN(7)=(1.0+X)*(1.0+Y)*(1.0+Z)*0.125
	VN(8)=(1.0+X)*(1.0-Y)*(1.0+Z)*0.125
	VN(9)=(1.0-X*X)
	VN(10)=(1.0-Y*Y)
	VN(11)=(1.0-Z*Z)

!====================================================
!=========SOLID八节点单元的形函数对自然坐标的导数========
	VDN(1,1)=-(1.0-Y)*(1.0-Z)*0.125
      VDN(1,2)=-(1.0+Y)*(1.0-Z)*0.125
	VDN(1,3)=-(1.0+Y)*(1.0+Z)*0.125
	VDN(1,4)=-(1.0-Y)*(1.0+Z)*0.125
	VDN(1,5)= (1.0-Y)*(1.0-Z)*0.125
	VDN(1,6)= (1.0+Y)*(1.0-Z)*0.125
	VDN(1,7)= (1.0+Y)*(1.0+Z)*0.125
	VDN(1,8)= (1.0-Y)*(1.0+Z)*0.125
      VDN(1,9)= -2.0*X
	VDN(1,10)= 0.0
	VDN(1,11)= 0.0

      VDN(2,1)=-(1.0-X)*(1.0-Z)*0.125
      VDN(2,2)= (1.0-X)*(1.0-Z)*0.125
	VDN(2,3)= (1.0-X)*(1.0+Z)*0.125
	VDN(2,4)=-(1.0-X)*(1.0+Z)*0.125
	VDN(2,5)=-(1.0+X)*(1.0-Z)*0.125
	VDN(2,6)= (1.0+X)*(1.0-Z)*0.125
	VDN(2,7)= (1.0+X)*(1.0+Z)*0.125
	VDN(2,8)=-(1.0+X)*(1.0+Z)*0.125
	VDN(2,9)=  0.0
	VDN(2,10)=-2.0*Y
	VDN(2,11)= 0.0

	VDN(3,1)=-(1.0-X)*(1.0-Y)*0.125
      VDN(3,2)=-(1.0-X)*(1.0+Y)*0.125
	VDN(3,3)= (1.0-X)*(1.0+Y)*0.125
	VDN(3,4)= (1.0-X)*(1.0-Y)*0.125
	VDN(3,5)=-(1.0+X)*(1.0-Y)*0.125
	VDN(3,6)=-(1.0+X)*(1.0+Y)*0.125
	VDN(3,7)= (1.0+X)*(1.0+Y)*0.125
	VDN(3,8)= (1.0+X)*(1.0-Y)*0.125
	VDN(3,9)=  0.0
	VDN(3,10)= 0.0
	VDN(3,11)=-2.0*Z

!====================================================
      E=VMAE(1)
	BO=VMAE(2)
	ROU=VMAE(3)
      VD(:,:)=0.0      !形成弹性矩阵
	VD(1,1)=1.0
	VD(1,2)=BO/(1-BO)
	VD(1,3)=BO/(1-BO)

      VD(2,1)=BO/(1-BO)
	VD(2,2)=1.0
	VD(2,3)=BO/(1-BO)

      VD(3,1)=BO/(1-BO)
	VD(3,2)=BO/(1-BO)
	VD(3,3)=1.0

	VD(4,4)=(1-2*BO)/(2*(1-BO))
	VD(5,5)=(1-2*BO)/(2*(1-BO))
	VD(6,6)=(1-2*BO)/(2*(1-BO))
	VD(:,:)=VD(:,:)*E*(1-BO)/((1+BO)*(1-2*BO))
!=============计算雅克比矩阵及雅克比行列式===========
	DO 10 I=1,3
	DO 10 J=1,3
	VJJ(I,J)=0.0
	DO 10 K=1,8
      VJJ(I,J)=VJJ(I,J)+VDN(I,K)*SXY(K,J) !雅克比矩阵
10    CONTINUE

      SJ8=VJJ(1,1)*(VJJ(2,2)*VJJ(3,3)-VJJ(2,3)*VJJ(3,2))-
     $    VJJ(1,2)*(VJJ(2,1)*VJJ(3,3)-VJJ(2,3)*VJJ(3,1))+
     $    VJJ(1,3)*(VJJ(2,2)*VJJ(3,1)-VJJ(2,1)*VJJ(3,2))  !雅克比行列式
!====================================================
      VJ(:,:)=0.0
	VJ(:,:)=.I.VJJ  !计算雅克比矩阵的逆阵

	VJ1(:,:)=VJ1(:,:)/ABS(SJ8)  !求逆犯规雅克比你矩阵

      DO 11 I=1,3
	DO 11 J=1,8
	VD0(I,J)=0.0
      DO 11 K=1,3
      VD0(I,J)=VD0(I,J)+VJ(I,K)*VDN(K,J)   !形函数对全局坐标的导数
11    CONTINUE

      DO 40 I=1,3
	DO 40 J=9,11
	VD0(I,J)=0.0
	DO 40 K=1,3
      VD0(I,J)=VD0(I,J)+VJ1(I,K)*VDN(K,J)
40    CONTINUE
	
	VB(:,:)=0.0
      DO 12 I=1,8
	VB(1,(I-1)*3+1)=VD0(1,I)   !形成应变矩阵
      VB(2,(I-1)*3+2)=VD0(2,I)
	VB(3,(I-1)*3+3)=VD0(3,I)
      VB(4,(I-1)*3+1)=VD0(2,I)
      VB(4,(I-1)*3+2)=VD0(1,I)
      VB(5,(I-1)*3+2)=VD0(3,I)
	VB(5,(I-1)*3+3)=VD0(2,I)
	VB(6,(I-1)*3+1)=VD0(3,I)
	VB(6,(I-1)*3+3)=VD0(1,I)
12    CONTINUE

      VB(1,25:27)=VD0(1,9:11)
      VB(4,25:27)=VD0(2,9:11)
	VB(6,25:27)=VD0(3,9:11)

      VB(2,28:30)=VD0(2,9:11)
      VB(4,28:30)=VD0(1,9:11)
	VB(5,28:30)=VD0(3,9:11)
      
	VB(3,31:33)=VD0(3,9:11)
      VB(5,31:33)=VD0(2,9:11)
	VB(6,31:33)=VD0(1,9:11)
 
      DO 13 I=1,33
	DO 13 J=1,6
      VS(I,J)=0.0
	DO 13 K=1,6
	VS(I,J)=VS(I,J)+VB(K,I)*VD(K,J)    
13    CONTINUE

      DO 14 I=1,33
	DO 14 J=1,33
	SK(I,J)=0.0
	DO 14 K=1,6
      SK(I,J)=SK(I,J)+VS(I,K)*VB(K,J)*ABS(SJ8) !刚度矩阵
14    CONTINUE

	VNN(:,:)=0.0
      DO 15 I=1,8
      VNN(1,(I-1)*3+1)=VN(I)
      VNN(2,(I-1)*3+2)=VN(I)
	VNN(3,(I-1)*3+3)=VN(I)
15    CONTINUE

      DO 16 I=1,24
	DO 16 J=1,24
	SM(I,J)=0.0
	DO 16 K=1,3
	SM(I,J)=SM(I,J)+VNN(K,I)*VNN(K,J)*ABS(SJ8)*ROU
16    CONTINUE
!=======================================================
C*******************************************************    
	RETURN
     	END

