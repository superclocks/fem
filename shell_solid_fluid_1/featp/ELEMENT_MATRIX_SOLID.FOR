      SUBROUTINE  ELEMENT_MATRIX_SOLID(SXY,SCOS,GSK,GSM,VMAE)
      IMPLICIT REAL*8 (A-H,O-Z)

      DIMENSION  SXY(8,3),SCOS(3,3),VMAE(4),GSK(24,24),GSM(24,24),
     $           GSK1(24,24),GSM1(24,24),TR(24,24)
      


      CALL SOLID_TRANS(SXY,SCOS)
C++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      KEYOPT_1=1    !控制参数
      SELECT CASE(KEYOPT_1)
C***************************带有额外形函数的实体单元*******************************
      CASE(0)
	CALL SOLID0_II(SXY,VMAE,GSK,GSM)
C**********************************************************************************
C***************************不带额外形函数的实体单元*******************************
      CASE(1)
      CALL SOLID1_II(SXY,VMAE,GSK,GSM,KEYOPT2)
C**********************************************************************************
      

C****************************形成变换矩阵TR(24,24)****************************** 
      END SELECT
      TR(:,:)=0.0
	DO 43 I=1,8
      II=(I-1)*3+1
      TR(II:II+2,II:II+2)=SCOS(:,:)
43    CONTINUE
C**********************************************************************************
C*******************将局部坐标下的单元矩阵变换到整体坐标系中***********************
      DO 44 I=1,24
	DO 44 J=1,24
	GSK1(I,J)=0.0
	GSM1(I,J)=0.0
	DO 44 K=1,24
	GSK1(I,J)=GSK1(I,J)+TR(I,K)*GSK(K,J)
	GSM1(I,J)=GSM1(I,J)+TR(I,K)*GSM(K,J)
44    CONTINUE

      DO 45 I=1,24
	DO 45 J=1,24
      GSK(I,J)=0.0
      GSM(I,J)=0.0
	DO 45 K=1,24
	GSK(I,J)=GSK(I,J)+GSK1(I,K)*TR(J,K)
	GSM(I,J)=GSM(I,J)+GSM1(I,K)*TR(J,K)
45    CONTINUE
C**********************************************************************************
     
      RETURN
      END