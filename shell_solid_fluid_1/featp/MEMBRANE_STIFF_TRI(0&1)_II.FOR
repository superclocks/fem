
	SUBROUTINE MEMBRANE_STIFF_TRI1_II(VX,TKK1,TMM1,VMAE)
	IMPLICIT   REAL*8 (A-H,O-z)
      
      DIMENSION  IEL(4),VX(3,3),VK(9,9),VM(9,9),AJ(2,2),AJJ(2,2),
     $        TKK1(9,9),TMM1(9,9),VDN(2,4),Q(9),AA(9,9),
     $        VD(3,3),VMAE(4)
    
      TKK1(:,:)=0.0
	TMM1(:,:)=0.0
C****************用一点高斯积分计算三角形单元的刚度,质量矩阵*************     
	X=1.0/3.0
	Y=1.0/3.0
	Z=1.0/3.0
	CALL MEMBRANE_STIFF_TRI1_I(VX,VK,VM,X,Y,Z,VMAE)
      VK(:,:)=VK(:,:)*0.5
	TMM1(:,:)=VM(:,:)*0.5
C************************三角形单元的单元矩阵计算完毕*******************

C***************************加入弹簧类型的转动刚度**********************
      S=0.5*ABS(VX(2,1)*VX(3,2)-VX(3,1)*VX(2,2)+
     $      VX(3,1)*VX(1,2)-VX(1,1)*VX(3,2)+
     $      VX(1,1)*VX(2,2)-VX(2,1)*VX(1,2))

	Q(1)= 0.25*(VX(2,1)-VX(3,1))/S  
	Q(2)= 0.25*(VX(2,2)-VX(3,2))/S 
	Q(3)=-1.0/3.0
	Q(4)= 0.25*(VX(3,1)-VX(1,1))/S 
	Q(5)= 0.25*(VX(3,2)-VX(1,2))/S 
	Q(6)=-1.0/3.0
	Q(7)= 0.25*(VX(1,1)-VX(2,1))/S 
	Q(8)= 0.25*(VX(1,2)-VX(2,2))/S 
	Q(9)=-1.0/3.0 

	DO 10 I=1,9
	DO 10 J=1,9
	AA(I,J)=Q(I)*Q(J)
10    CONTINUE
      
	G=VMAE(1)/((1.0+VMAE(2))*2.0)   !剪切模量
	TKK1(:,:)=0.01*S*AA(:,:)*G*VMAE(4)+VK(:,:)
C****************************弹簧转动刚度计算结束***********************
C***********************加入一个小的刚度防止数值不稳定******************
      X=G*VMAE(4)*ABS(S)*1E-8
      TKK1(3,3)=TKK1(3,3)+X
	TKK1(6,6)=TKK1(6,6)+X
	TKK1(9,9)=TKK1(9,9)+X
C***********************************************************************
	RETURN
	END